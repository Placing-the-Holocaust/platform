(window.webpackJsonp=window.webpackJsonp||[]).push([[13,6],{284:function(e,t,r){var content=r(288);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(48).default)("1c28cb17",content,!0,{sourceMap:!1})},287:function(e,t,r){"use strict";r(284)},288:function(e,t,r){var n=r(47)((function(i){return i[1]}));n.push([e.i,".search-form[data-v-21b6fcc0]{background:#f8f8f8;border:1px solid #ddd;border-radius:5px;padding:20px}.field-group[data-v-21b6fcc0]{margin-bottom:10px}.toggle-section[data-v-21b6fcc0]{margin:15px 0}button[data-v-21b6fcc0]{background:#007bff;border:none;color:#fff;cursor:pointer;margin-top:10px;padding:10px}",""]),n.locals={},e.exports=n},290:function(e,t,r){"use strict";r.r(t);r(111),r(50),r(49),r(66),r(21);var n={name:"SearchForm",props:{genders:{type:Array,default:function(){return[]}},countries:{type:Array,default:function(){return[]}},experienceGroups:{type:Array,default:function(){return[]}},birthYears:{type:Array,default:function(){return[]}},placeLabelOptions:{type:Array,default:function(){return[]}}},data:function(){return{queryType:"Vector",queryText:"",togglePlaces:!1,selectedPlaces:[],toggleTestimonyFilters:!1,category:[],selectedGender:"",selectedCountry:"",selectedExperienceGroup:"",selectedBirthYear:"",rgNumber:"",fullName:"",toggleAdvanced:!1,numResults:100}},methods:{submitSearch:function(){var e={queryType:this.queryType,queryText:this.queryText,placesHeader:this.togglePlaces,labels:this.selectedPlaces,testimonyFilters:this.toggleTestimonyFilters,category:this.category,gender:this.selectedGender,country:this.selectedCountry,experienceGroup:this.selectedExperienceGroup,birthYear:this.selectedBirthYear,rgNumber:this.rgNumber,fullName:this.fullName,advanced:this.toggleAdvanced,numResults:this.numResults};this.$emit("search-submitted",e)}}},o=(r(287),r(32)),component=Object(o.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"search-form"},[t("form",{on:{submit:function(t){return t.preventDefault(),e.submitSearch.apply(null,arguments)}}},[t("div",{staticClass:"field-group"},[t("label",[e._v("Query Text")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.queryText,expression:"queryText"}],attrs:{type:"text",placeholder:"Enter your search term"},domProps:{value:e.queryText},on:{input:function(t){t.target.composing||(e.queryText=t.target.value)}}})]),e._v(" "),t("div",{staticClass:"field-group"},[t("label",[e._v("Type of Search")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.queryType,expression:"queryType"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.queryType=t.target.multiple?r:r[0]}}},[t("option",[e._v("Vector")]),e._v(" "),t("option",[e._v("Keyword")]),e._v(" "),t("option",[e._v("Hybrid")])])]),e._v(" "),t("div",{staticClass:"toggle-section"},[t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.togglePlaces,expression:"togglePlaces"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.togglePlaces)?e._i(e.togglePlaces,null)>-1:e.togglePlaces},on:{change:function(t){var r=e.togglePlaces,n=t.target,o=!!n.checked;if(Array.isArray(r)){var l=e._i(r,null);n.checked?l<0&&(e.togglePlaces=r.concat([null])):l>-1&&(e.togglePlaces=r.slice(0,l).concat(r.slice(l+1)))}else e.togglePlaces=o}}}),e._v("\n        Places Filter\n      ")])]),e._v(" "),e.togglePlaces?t("div",{staticClass:"places-panel"},[t("label",[e._v("Select Place Labels")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedPlaces,expression:"selectedPlaces"}],attrs:{multiple:""},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedPlaces=t.target.multiple?r:r[0]}}},e._l(e.placeLabelOptions,(function(r,n){return t("option",{key:n,domProps:{value:r.label}},[e._v("\n          "+e._s(r.label)+"\n        ")])})),0)]):e._e(),e._v(" "),t("div",{staticClass:"toggle-section"},[t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.toggleTestimonyFilters,expression:"toggleTestimonyFilters"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.toggleTestimonyFilters)?e._i(e.toggleTestimonyFilters,null)>-1:e.toggleTestimonyFilters},on:{change:function(t){var r=e.toggleTestimonyFilters,n=t.target,o=!!n.checked;if(Array.isArray(r)){var l=e._i(r,null);n.checked?l<0&&(e.toggleTestimonyFilters=r.concat([null])):l>-1&&(e.toggleTestimonyFilters=r.slice(0,l).concat(r.slice(l+1)))}else e.toggleTestimonyFilters=o}}}),e._v("\n        Testimony Filters\n      ")])]),e._v(" "),e.toggleTestimonyFilters?t("div",{staticClass:"testimony-panel"},[t("div",[t("label",[e._v("Category")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.category,expression:"category"}],attrs:{multiple:""},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.category=t.target.multiple?r:r[0]}}},[t("option",[e._v("question")]),e._v(" "),t("option",[e._v("answer")])])]),e._v(" "),t("div",[t("label",[e._v("Gender")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedGender,expression:"selectedGender"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedGender=t.target.multiple?r:r[0]}}},[t("option",{attrs:{value:""}},[e._v("All")]),e._v(" "),e._l(e.genders,(function(g,i){return t("option",{key:i,domProps:{value:g}},[e._v(e._s(g))])}))],2)]),e._v(" "),t("div",[t("label",[e._v("Country")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedCountry,expression:"selectedCountry"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedCountry=t.target.multiple?r:r[0]}}},[t("option",{attrs:{value:""}},[e._v("All")]),e._v(" "),e._l(e.countries,(function(r,i){return t("option",{key:i,domProps:{value:r}},[e._v(e._s(r))])}))],2)]),e._v(" "),t("div",[t("label",[e._v("Experience Group")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedExperienceGroup,expression:"selectedExperienceGroup"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedExperienceGroup=t.target.multiple?r:r[0]}}},[t("option",{attrs:{value:""}},[e._v("All")]),e._v(" "),e._l(e.experienceGroups,(function(r,i){return t("option",{key:i,domProps:{value:r}},[e._v(e._s(r))])}))],2)]),e._v(" "),t("div",[t("label",[e._v("Birth Year")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedBirthYear,expression:"selectedBirthYear"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedBirthYear=t.target.multiple?r:r[0]}}},[t("option",{attrs:{value:""}},[e._v("All")]),e._v(" "),e._l(e.birthYears,(function(r,i){return t("option",{key:i,domProps:{value:r}},[e._v(e._s(r))])}))],2)]),e._v(" "),t("div",[t("label",[e._v("RG Number")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.rgNumber,expression:"rgNumber"}],attrs:{type:"text",placeholder:"RG..."},domProps:{value:e.rgNumber},on:{input:function(t){t.target.composing||(e.rgNumber=t.target.value)}}})]),e._v(" "),t("div",[t("label",[e._v("Full Name")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.fullName,expression:"fullName"}],attrs:{type:"text"},domProps:{value:e.fullName},on:{input:function(t){t.target.composing||(e.fullName=t.target.value)}}})])]):e._e(),e._v(" "),t("div",{staticClass:"toggle-section"},[t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.toggleAdvanced,expression:"toggleAdvanced"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.toggleAdvanced)?e._i(e.toggleAdvanced,null)>-1:e.toggleAdvanced},on:{change:function(t){var r=e.toggleAdvanced,n=t.target,o=!!n.checked;if(Array.isArray(r)){var l=e._i(r,null);n.checked?l<0&&(e.toggleAdvanced=r.concat([null])):l>-1&&(e.toggleAdvanced=r.slice(0,l).concat(r.slice(l+1)))}else e.toggleAdvanced=o}}}),e._v("\n        Advanced Options\n      ")])]),e._v(" "),e.toggleAdvanced?t("div",{staticClass:"advanced-panel"},[t("label",[e._v("Number of Results")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.numResults,expression:"numResults",modifiers:{number:!0}}],attrs:{type:"number",min:"1",max:"1000"},domProps:{value:e.numResults},on:{input:function(t){t.target.composing||(e.numResults=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]):e._e(),e._v(" "),t("button",{attrs:{type:"submit"}},[e._v("Search")])])])}),[],!1,null,"21b6fcc0",null);t.default=component.exports},296:function(e,t,r){var content=r(312);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(48).default)("745455ac",content,!0,{sourceMap:!1})},310:function(e,t,r){"use strict";var n=r(2),o=r(3),l=r(51),c=r(202),d=r(201),v=r(4),m=RangeError,f=String,h=Math.floor,_=o(d),y=o("".slice),x=o(1..toFixed),T=function(e,t,r){return 0===t?r:t%2==1?T(e,t-1,r*e):T(e*e,t/2,r)},A=function(data,e,t){for(var r=-1,n=t;++r<6;)n+=e*data[r],data[r]=n%1e7,n=h(n/1e7)},w=function(data,e){for(var t=6,r=0;--t>=0;)r+=data[t],data[t]=h(r/e),r=r%e*1e7},N=function(data){for(var e=6,s="";--e>=0;)if(""!==s||0===e||0!==data[e]){var t=f(data[e]);s=""===s?t:s+_("0",7-t.length)+t}return s};n({target:"Number",proto:!0,forced:v((function(){return"0.000"!==x(8e-5,3)||"1"!==x(.9,0)||"1.25"!==x(1.255,2)||"1000000000000000128"!==x(0xde0b6b3a7640080,0)}))||!v((function(){x({})}))},{toFixed:function(e){var t,r,n,o,d=c(this),v=l(e),data=[0,0,0,0,0,0],h="",x="0";if(v<0||v>20)throw new m("Incorrect fraction digits");if(d!=d)return"NaN";if(d<=-1e21||d>=1e21)return f(d);if(d<0&&(h="-",d=-d),d>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(d*T(2,69,1))-69)<0?d*T(2,-t,1):d/T(2,t,1),r*=4503599627370496,(t=52-t)>0){for(A(data,0,r),n=v;n>=7;)A(data,1e7,0),n-=7;for(A(data,T(10,n,1),0),n=t-1;n>=23;)w(data,1<<23),n-=23;w(data,1<<n),A(data,1,1),w(data,2),x=N(data)}else A(data,0,r),A(data,1<<-t,0),x=N(data)+_("0",v);return x=v>0?h+((o=x.length)<=v?"0."+_("0",v-o)+x:y(x,0,o-v)+"."+y(x,o-v)):h+x}})},311:function(e,t,r){"use strict";r(296)},312:function(e,t,r){var n=r(47)((function(i){return i[1]}));n.push([e.i,".search-page[data-v-a25e2b4a]{display:flex;flex-direction:column;height:100vh;padding:20px}.page-title[data-v-a25e2b4a]{font-size:1.8em;margin-bottom:10px}.search-container[data-v-a25e2b4a]{display:flex;flex:1;flex-direction:row;overflow:hidden}.search-menu[data-v-a25e2b4a]{background:#f9f9f9;border-right:1px solid #ddd;margin-right:20px;min-width:240px;overflow-y:auto;padding:10px;width:300px}.results-container[data-v-a25e2b4a]{background:#fff;border-left:1px solid #ddd;flex:1;overflow-y:auto;padding:10px}.results-table-wrapper[data-v-a25e2b4a]{overflow-x:auto}table[data-v-a25e2b4a]{border-collapse:collapse;width:100%}td[data-v-a25e2b4a],th[data-v-a25e2b4a]{border:1px solid #ddd;padding:8px}th[data-v-a25e2b4a]{background:#f0f0f0}.loading-indicator[data-v-a25e2b4a]{color:#777;font-style:italic}.no-results[data-v-a25e2b4a]{color:#666;margin-top:20px}.menu-title[data-v-a25e2b4a]{font-size:1.2em;font-weight:600;margin-bottom:10px}",""]),n.locals={},e.exports=n},325:function(e,t,r){"use strict";r.r(t);var n=r(12),o=(r(67),r(111),r(50),r(143),r(49),r(310),r(21),r(38),{name:"SearchPage",components:{SearchForm:r(290).default},data:function(){return{loading:!0,searched:!1,results:[],genders:[],countries:[],experienceGroups:[],birthYears:[],placeLabelMap:{Regions:"REGION",Countries:"COUNTRY","Populated Places":"POPULATED_PLACE","Environmental Features":"ENV_FEATURES","Distinct Landscape Features":"DLF",Buildings:"BUILDING","Interior Spaces":"INT_SPACE","Spatial Objects":"SPATIAL_OBJECT","Imaginary Places":"NPIP"},placeLabelOptions:[{label:"Regions"},{label:"Countries"},{label:"Populated Places"},{label:"Environmental Features"},{label:"Distinct Landscape Features"},{label:"Buildings"},{label:"Interior Spaces"},{label:"Spatial Objects"},{label:"Imaginary Places"}]}},created:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r="".concat("/platform","/data/filters.json"),t.next=5,fetch(r);case 5:return n=t.sent,t.next=8,n.json();case 8:o=t.sent,e.genders=o.genders||[],e.countries=o.countries||[],e.experienceGroups=o.experience_groups||[],e.birthYears=o.birth_years||[],e.loading=!1,t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),console.error("Failed to load filters.json",t.t0),e.loading=!1;case 20:case"end":return t.stop()}}),t,null,[[0,16]])})))()},methods:{onSearchFormSubmitted:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.searched=!0,console.log("Search form data:",e),r.prev=2,r.next=5,t.doWeaviateQuery(e);case 5:n=r.sent,t.results=n,r.next=13;break;case 9:r.prev=9,r.t0=r.catch(2),console.error("Error during Weaviate query:",r.t0),t.results=[];case 13:case"end":return r.stop()}}),r,null,[[2,9]])})))()},generateEmbedding:function(e){return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",[]);case 2:return r={inputs:e},t.prev=5,t.next=8,fetch("https://api-inference.huggingface.co/models/".concat("sentence-transformers/all-MiniLM-L6-v2"),{method:"POST",headers:{Authorization:"Bearer ".concat("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"),"Content-Type":"application/json"},body:JSON.stringify(r)});case 8:if((o=t.sent).ok){t.next=11;break}throw new Error("Hugging Face API error: ".concat(o.status));case 11:return t.next=13,o.json();case 13:if(data=t.sent,Array.isArray(data)&&null!==(n=data[0])&&void 0!==n&&n.embedding){t.next=16;break}throw new Error("Unexpected HF response format: ".concat(JSON.stringify(data)));case 16:return t.abrupt("return",data[0].embedding);case 19:return t.prev=19,t.t0=t.catch(5),console.error("Error generating embedding. Continuing without embeddings.",t.t0),t.abrupt("return",[]);case 23:case"end":return t.stop()}}),t,null,[[5,19]])})))()},doWeaviateQuery:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,l,c,d,v,m;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.queryText||"",r.next=3,t.generateEmbedding(n);case 3:return o=r.sent,console.log("Embedding length:",o.length),l=t.buildGraphQLQuery(e,o),console.log("GraphQL Query:",l),r.prev=9,r.next=12,fetch("http://acg-floating-204-197-5-43.acg.maine.edu:8080/v1/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat("wNIf2XunX2THHTK6y1aDEr0lyj0FFv4x6KqT")},body:JSON.stringify({query:l})});case 12:if((d=r.sent).ok){r.next=15;break}throw new Error("HTTP error! status: ".concat(d.status));case 15:return r.next=17,d.json();case 17:return v=r.sent,console.log("Weaviate Response:",v),(m=(null===(c=v.data)||void 0===c||null===(c=c.Get)||void 0===c?void 0:c.HolocaustTestimonies)||[]).forEach((function(e){var t;void 0!==(null===(t=e._additional)||void 0===t?void 0:t.distance)&&(e.score=parseFloat((1-e._additional.distance).toFixed(3)))})),r.abrupt("return",m);case 24:return r.prev=24,r.t0=r.catch(9),console.error("Weaviate query error:",r.t0),r.abrupt("return",[]);case 28:case"end":return r.stop()}}),r,null,[[9,24]])})))()},buildGraphQLQuery:function(e,t){var r=this.buildWhereClause(e),n=e.numResults||100,o="";return t&&t.length&&(o="\n          nearVector: {\n            vector: [".concat(t.join(","),"]\n          }\n        ")),"\n      query {\n        Get {\n          HolocaustTestimonies(\n            limit: ".concat(n,",\n            ").concat(o,"\n            ").concat(r,"\n          ) {\n            rg\n            full_name\n            birth_year\n            gender\n            country\n            experience_group\n            text\n            _additional {\n              distance\n            }\n          }\n        }\n      }")},buildWhereClause:function(e){var t=this,r=[];e.gender&&""!==e.gender&&r.push('{\n          operator: Equal\n          path: ["gender"]\n          valueText: "'.concat(e.gender,'"\n        }')),e.country&&""!==e.country&&r.push('{\n          operator: Equal\n          path: ["country"]\n          valueText: "'.concat(e.country,'"\n        }')),e.experienceGroup&&""!==e.experienceGroup&&r.push('{\n          operator: Equal\n          path: ["experience_group"]\n          valueText: "'.concat(e.experienceGroup,'"\n        }')),e.birthYear&&""!==e.birthYear&&r.push('{\n          operator: Equal\n          path: ["birth_year"]\n          valueInt: '.concat(e.birthYear,"\n        }")),e.rgNumber&&r.push('{\n          operator: Equal\n          path: ["rg"]\n          valueText: "'.concat(e.rgNumber,'"\n        }')),e.fullName&&r.push('{\n          operator: Equal\n          path: ["full_name"]\n          valueText: "'.concat(e.fullName,'"\n        }'));var n=e.labels||[];if(n.length){var o=n.map((function(e){var r=t.placeLabelMap[e]||"";return r?'{\n            operator: GreaterThan\n            path: ["'.concat(r,'"]\n            valueNumber: 0\n          }'):""})).filter(Boolean);o.length&&r.push("\n          {\n            operator: Or\n            operands: [\n              ".concat(o.join(","),"\n            ]\n          }\n          "))}return r.length?"\n      where: {\n        operator: And\n        operands: [\n          ".concat(r.join(","),"\n        ]\n      }"):""}}}),l=(r(311),r(32)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"search-page"},[t("h1",{staticClass:"page-title"},[e._v("Search Transcripts")]),e._v(" "),t("div",{staticClass:"search-container"},[t("div",{staticClass:"search-menu"},[t("h2",{staticClass:"menu-title"},[e._v("Search Menu")]),e._v(" "),e.loading?t("div",{staticClass:"loading-indicator"},[e._v("\n        Loading filter data...\n      ")]):e._e(),e._v(" "),e.loading?e._e():t("SearchForm",{attrs:{genders:e.genders,countries:e.countries,experienceGroups:e.experienceGroups,birthYears:e.birthYears,placeLabelOptions:e.placeLabelOptions},on:{"search-submitted":e.onSearchFormSubmitted}})],1),e._v(" "),t("div",{staticClass:"results-container"},[e.results.length?t("div",{staticClass:"results-table-wrapper"},[t("h2",[e._v("Results ("+e._s(e.results.length)+")")]),e._v(" "),t("table",[e._m(0),e._v(" "),t("tbody",e._l(e.results,(function(r,n){return t("tr",{key:n},[t("td",[e._v(e._s(r.rg))]),e._v(" "),t("td",[e._v(e._s(r.full_name))]),e._v(" "),t("td",[e._v(e._s(r.birth_year))]),e._v(" "),t("td",[e._v(e._s(r.gender))]),e._v(" "),t("td",[e._v(e._s(r.country))]),e._v(" "),t("td",[e._v(e._s(r.experience_group))]),e._v(" "),t("td",[e._v(e._s(r.text))]),e._v(" "),t("td",[e._v(e._s(r.score))])])})),0)])]):e.searched&&!e.results.length?t("div",{staticClass:"no-results"},[t("p",[e._v("No results found.")])]):e._e()])])])}),[function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("RG")]),e._v(" "),t("th",[e._v("Full Name")]),e._v(" "),t("th",[e._v("Birth Year")]),e._v(" "),t("th",[e._v("Gender")]),e._v(" "),t("th",[e._v("Country")]),e._v(" "),t("th",[e._v("Experience Group")]),e._v(" "),t("th",[e._v("Text")]),e._v(" "),t("th",[e._v("Score")])])])}],!1,null,"a25e2b4a",null);t.default=component.exports;installComponents(component,{SearchForm:r(290).default})}}]);